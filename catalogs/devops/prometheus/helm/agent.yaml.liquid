vmagent:
  enabled: true

  additionalRemoteWrites:
  - url: https://{{ context.host }}/insert/0/prometheus/api/v1/write
    basicAuth:
      username: 
        name: vm-auth
        key: user
      password:
        name: vm-auth
        key: password

  {% raw %}
  spec:
    externalLabels:
      cluster: {{ cluster.handle }}
  {% endraw %}

prometheus-operator-crds:
  enabled: true

vmalert:
  enabled: false

alertmanager:
  enabled: false

vmsingle:
  enabled: false

grafana:
  enabled: false

vmcluster:
  enabled: false

kubeApiServer:
  enabled: false

victoria-metrics-operator:
  operator:
    enable_converter_ownership: true

  image:
    registry: "quay.io"
  env:
    - name: VM_CUSTOMCONFIGRELOADERIMAGE
      value: "quay.io/victoriametrics/operator:config-reloader-v0.53.0"
    - name: VM_VLOGSDEFAULT_IMAGE
      value: "quay.io/victoriametrics/victoria-logs"
    - name: VM_VMALERTDEFAULT_IMAGE
      value: "quay.io/victoriametrics/vmalert"
    - name: VM_VMAGENTDEFAULT_IMAGE
      value: "quay.io/victoriametrics/vmagent"
    - name: VM_VMSINGLEDEFAULT_IMAGE
      value: "quay.io/victoriametrics/victoria-metrics"
    - name: VM_VMCLUSTERDEFAULT_VMSELECTDEFAULT_IMAGE
      value: "quay.io/victoriametrics/vmselect"
    - name: VM_VMCLUSTERDEFAULT_VMSTORAGEDEFAULT_IMAGE
      value: "quay.io/victoriametrics/vmstorage"
    - name: VM_VMCLUSTERDEFAULT_VMINSERTDEFAULT_IMAGE
      value: "quay.io/victoriametrics/vminsert"
    - name: VM_VMBACKUP_IMAGE
      value: "quay.io/victoriametrics/vmbackupmanager"
    - name: VM_VMAUTHDEFAULT_IMAGE
      value: "quay.io/victoriametrics/vmauth"
    - name: VM_VMALERTMANAGER_ALERTMANAGERDEFAULTBASEIMAGE
      value: "quay.io/prometheus/alertmanager"

extraObjects:
- apiVersion: v1
  kind: Secret
  metadata:
    name: vm-auth
  stringData:
  {% raw %}
    password: {{ configuration.password }}
    user: {{ configuration.username }}
  {% endraw %}